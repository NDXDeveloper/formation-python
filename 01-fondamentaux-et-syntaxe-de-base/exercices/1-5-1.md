# Exercice 1 : Gestionnaire de division sÃ©curisÃ©e

## Objectif

CrÃ©er un programme qui effectue des divisions avec une gestion complÃ¨te des erreurs et maintient un historique des calculs rÃ©ussis.

## Cahier des charges

1. **Demander deux nombres** Ã  l'utilisateur
2. **Effectuer la division** avec gestion d'erreurs
3. **GÃ©rer les cas d'erreur** : nombres invalides, division par zÃ©ro
4. **Permettre de recommencer** en cas d'erreur
5. **Afficher un historique** des calculs rÃ©ussis

## Code de base Ã  complÃ©ter

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Exercice 1 : Gestionnaire de division sÃ©curisÃ©e
Module 1.5 - Gestion des erreurs avec try/except
"""

def demander_nombre(message):
    """
    Demande un nombre Ã  l'utilisateur avec gestion d'erreurs.

    Args:
        message (str): Message Ã  afficher

    Returns:
        float: Le nombre saisi ou None si annulÃ©
    """
    # TODO: ImplÃ©menter la fonction
    pass

def effectuer_division(a, b):
    """
    Effectue une division sÃ©curisÃ©e.

    Args:
        a (float): Dividende
        b (float): Diviseur

    Returns:
        float: RÃ©sultat de la division

    Raises:
        ZeroDivisionError: Si b = 0
    """
    # TODO: ImplÃ©menter la fonction
    pass

def afficher_historique(historique):
    """
    Affiche l'historique des calculs.

    Args:
        historique (list): Liste des calculs rÃ©ussis
    """
    # TODO: ImplÃ©menter la fonction
    pass

def main():
    """Fonction principale du gestionnaire de division."""
    print("ğŸ§® === GESTIONNAIRE DE DIVISION SÃ‰CURISÃ‰E ===")

    historique = []

    while True:
        try:
            print("\n" + "â”€" * 50)
            print("1. Effectuer une division")
            print("2. Afficher l'historique")
            print("3. Quitter")

            choix = input("\nVotre choix (1-3) : ").strip()

            if choix == "1":
                # TODO: ImplÃ©menter la logique de division
                pass

            elif choix == "2":
                # TODO: Afficher l'historique
                pass

            elif choix == "3":
                # TODO: Afficher les statistiques et quitter
                pass

            else:
                print("âŒ Choix invalide. Veuillez entrer 1, 2 ou 3.")

        except KeyboardInterrupt:
            # TODO: GÃ©rer l'interruption clavier
            pass

        except Exception as e:
            # TODO: GÃ©rer les erreurs inattendues
            pass

if __name__ == "__main__":
    main()
```

## Solution complÃ¨te

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Exercice 1 : Gestionnaire de division sÃ©curisÃ©e - SOLUTION
Module 1.5 - Gestion des erreurs avec try/except
"""

from datetime import datetime

def demander_nombre(message):
    """
    Demande un nombre Ã  l'utilisateur avec gestion d'erreurs.

    Args:
        message (str): Message Ã  afficher

    Returns:
        float: Le nombre saisi ou None si annulÃ©
    """
    while True:
        try:
            entree = input(message)
            return float(entree)

        except ValueError:
            print("âŒ Veuillez entrer un nombre valide (ex: 10, 3.14, -5)")

        except KeyboardInterrupt:
            print("\nâ¹ï¸ Saisie annulÃ©e")
            return None

def effectuer_division(a, b):
    """
    Effectue une division sÃ©curisÃ©e.

    Args:
        a (float): Dividende
        b (float): Diviseur

    Returns:
        float: RÃ©sultat de la division

    Raises:
        ZeroDivisionError: Si b = 0
    """
    if b == 0:
        raise ZeroDivisionError("Division par zÃ©ro impossible")

    return a / b

def afficher_historique(historique):
    """
    Affiche l'historique des calculs.

    Args:
        historique (list): Liste des calculs rÃ©ussis
    """
    if not historique:
        print("ğŸ“­ Aucun calcul dans l'historique")
        return

    print(f"\nğŸ“š Historique des divisions ({len(historique)} calcul(s)) :")
    print("â•" * 60)

    for i, calcul in enumerate(historique, 1):
        print(f"{i:2d}. {calcul['expression']} = {calcul['resultat']:.6f}")
        print(f"     â””â”€ {calcul['timestamp']}")

    print("â•" * 60)

    # Statistiques
    resultats = [c['resultat'] for c in historique]
    print(f"\nğŸ“Š Statistiques :")
    print(f"   â€¢ Plus grand rÃ©sultat : {max(resultats):.6f}")
    print(f"   â€¢ Plus petit rÃ©sultat : {min(resultats):.6f}")
    print(f"   â€¢ Moyenne des rÃ©sultats : {sum(resultats)/len(resultats):.6f}")

def main():
    """Fonction principale du gestionnaire de division."""
    print("ğŸ§® === GESTIONNAIRE DE DIVISION SÃ‰CURISÃ‰E ===")
    print("Ce programme effectue des divisions avec gestion complÃ¨te d'erreurs")

    historique = []

    while True:
        try:
            print("\n" + "â”€" * 50)
            print("1. ğŸ”¢ Effectuer une division")
            print("2. ğŸ“š Afficher l'historique")
            print("3. ğŸ“Š Statistiques")
            print("4. âŒ Quitter")

            choix = input("\nVotre choix (1-4) : ").strip()

            if choix == "1":
                print("\nâ— === NOUVELLE DIVISION ===")

                # Demander le dividende
                dividende = demander_nombre("Dividende (nombre Ã  diviser) : ")
                if dividende is None:
                    continue

                # Demander le diviseur
                diviseur = demander_nombre("Diviseur (nombre qui divise) : ")
                if diviseur is None:
                    continue

                # Effectuer la division
                try:
                    resultat = effectuer_division(dividende, diviseur)

                    # CrÃ©er l'entrÃ©e d'historique
                    calcul = {
                        'expression': f"{dividende} Ã· {diviseur}",
                        'resultat': resultat,
                        'timestamp': datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                    }

                    historique.append(calcul)

                    # Afficher le rÃ©sultat
                    print(f"\nâœ… RÃ©sultat : {dividende} Ã· {diviseur} = {resultat}")

                    # Informations additionnelles
                    if resultat == int(resultat):
                        print(f"   â„¹ï¸  Division exacte (pas de reste)")
                    else:
                        print(f"   â„¹ï¸  Division avec dÃ©cimales")

                    if abs(resultat) > 1000000:
                        print(f"   âš ï¸  RÃ©sultat trÃ¨s grand : {resultat:.2e}")
                    elif abs(resultat) < 0.000001:
                        print(f"   âš ï¸  RÃ©sultat trÃ¨s petit : {resultat:.2e}")

                except ZeroDivisionError as e:
                    print(f"âŒ Erreur de division : {e}")
                    print("   ğŸ’¡ Conseil : Le diviseur ne peut pas Ãªtre zÃ©ro")

                except Exception as e:
                    print(f"âŒ Erreur inattendue : {e}")

            elif choix == "2":
                afficher_historique(historique)

            elif choix == "3":
                if historique:
                    print(f"\nğŸ“Š === STATISTIQUES GÃ‰NÃ‰RALES ===")
                    print(f"   â€¢ Nombre total de divisions : {len(historique)}")

                    resultats = [c['resultat'] for c in historique]
                    positifs = sum(1 for r in resultats if r > 0)
                    negatifs = sum(1 for r in resultats if r < 0)

                    print(f"   â€¢ RÃ©sultats positifs : {positifs}")
                    print(f"   â€¢ RÃ©sultats nÃ©gatifs : {negatifs}")

                    if historique:
                        print(f"   â€¢ PremiÃ¨re division : {historique[0]['timestamp']}")
                        print(f"   â€¢ DerniÃ¨re division : {historique[-1]['timestamp']}")
                else:
                    print("ğŸ“­ Aucune statistique disponible (aucun calcul effectuÃ©)")

            elif choix == "4":
                if historique:
                    print(f"\nğŸ“‹ RÃ©sumÃ© de la session :")
                    print(f"   â€¢ {len(historique)} division(s) effectuÃ©e(s)")
                    print(f"   â€¢ Session terminÃ©e le {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")

                print("\nğŸ‘‹ Merci d'avoir utilisÃ© le gestionnaire de division !")
                print("Ã€ bientÃ´t ! ğŸ§®")
                break

            else:
                print("âŒ Choix invalide. Veuillez entrer un nombre entre 1 et 4.")

        except KeyboardInterrupt:
            print(f"\n\nâ¹ï¸ Programme interrompu par l'utilisateur")
            if historique:
                print(f"ğŸ’¾ Historique conservÃ© : {len(historique)} calcul(s)")
            print("ğŸ‘‹ Au revoir !")
            break

        except Exception as e:
            print(f"âŒ Erreur inattendue dans le menu : {e}")
            print("ğŸ”„ Retour au menu principal...")

if __name__ == "__main__":
    main()
```

## Tests Ã  effectuer

1. **Nombres valides** : 10 Ã· 2 = 5.0
2. **Division par zÃ©ro** : 10 Ã· 0 â†’ erreur gÃ©rÃ©e
3. **Nombres invalides** : "abc" â†’ erreur gÃ©rÃ©e
4. **Nombres dÃ©cimaux** : 7.5 Ã· 2.5 = 3.0
5. **Nombres nÃ©gatifs** : -10 Ã· 2 = -5.0
6. **Interruption clavier** : Ctrl+C pendant la saisie
7. **Historique vide** : Affichage correct
8. **Statistiques** : Calculs corrects

## CritÃ¨res d'Ã©valuation

- âœ… **Gestion d'erreurs complÃ¨te** : ValueError, ZeroDivisionError
- âœ… **Interface utilisateur claire** : Messages explicites
- âœ… **Historique fonctionnel** : Stockage et affichage
- âœ… **Interruption clavier** : Gestion de Ctrl+C
- âœ… **Code propre** : Fonctions bien organisÃ©es
- âœ… **Statistiques** : Calculs additionnels sur l'historique

## Extensions possibles

- Ajouter d'autres opÃ©rations (multiplication, soustraction)
- Sauvegarder l'historique dans un fichier
- Calculer des moyennes mobiles
- Ajouter un mode "calculatrice scientifique"
