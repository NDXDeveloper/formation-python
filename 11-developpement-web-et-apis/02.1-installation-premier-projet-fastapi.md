üîù Retour au [Sommaire](/SOMMAIRE.md)

# 11.2.1 Installation et premier projet FastAPI

## Introduction

FastAPI est un framework web moderne et performant pour cr√©er des APIs avec Python. Dans cette section, vous allez apprendre √† installer FastAPI et √† cr√©er votre tout premier projet. Nous allons proc√©der √©tape par √©tape pour que tout soit clair, m√™me si vous d√©butez.

## Pourquoi FastAPI ?

Avant de commencer, rappelons rapidement pourquoi FastAPI est un excellent choix :

- ‚ö° **Rapide** : Performances comparables √† Node.js et Go
- üéØ **Moderne** : Utilise les fonctionnalit√©s r√©centes de Python (type hints, async/await)
- üìù **Documentation automatique** : Interface Swagger g√©n√©r√©e automatiquement
- ‚úÖ **Validation** : V√©rification automatique des donn√©es avec Pydantic
- üî∞ **Facile √† apprendre** : Syntaxe intuitive et documentation excellente

## Pr√©requis

Avant de commencer, assurez-vous d'avoir :

- **Python 3.8 ou sup√©rieur** install√© sur votre ordinateur
- Des connaissances de base en Python (variables, fonctions, d√©corateurs)
- Un √©diteur de code (VS Code, PyCharm, Sublime Text, etc.)
- Un terminal ou invite de commande

Pour v√©rifier votre version de Python, ouvrez un terminal et tapez :

```bash
python --version
# ou
python3 --version
```

Si la version affich√©e est 3.8 ou sup√©rieure, vous √™tes pr√™t !

## √âtape 1 : Cr√©er un environnement virtuel

Il est fortement recommand√© de cr√©er un **environnement virtuel** pour chaque projet Python. Cela permet d'isoler les d√©pendances de votre projet et d'√©viter les conflits entre diff√©rentes versions de biblioth√®ques.

### Qu'est-ce qu'un environnement virtuel ?

Un environnement virtuel est comme une "bulle" isol√©e o√π vous pouvez installer des packages Python sans affecter votre installation Python syst√®me. Chaque projet peut avoir son propre environnement avec ses propres versions de biblioth√®ques.

### Cr√©er l'environnement virtuel

Ouvrez votre terminal et naviguez vers le dossier o√π vous souhaitez cr√©er votre projet :

```bash
# Cr√©er un dossier pour votre projet
mkdir mon_premier_fastapi
cd mon_premier_fastapi

# Cr√©er l'environnement virtuel
python -m venv venv
```

Cette commande cr√©e un dossier `venv` contenant votre environnement virtuel.

### Activer l'environnement virtuel

Maintenant, activez l'environnement virtuel :

**Sur Windows :**
```bash
venv\Scripts\activate
```

**Sur macOS/Linux :**
```bash
source venv/bin/activate
```

Vous devriez voir le nom de votre environnement virtuel `(venv)` appara√Ætre au d√©but de votre ligne de commande. Cela signifie que l'environnement est activ√© !

```bash
(venv) C:\Users\VotreNom\mon_premier_fastapi>
```

## √âtape 2 : Installer FastAPI et Uvicorn

Maintenant que votre environnement virtuel est activ√©, vous pouvez installer FastAPI et ses d√©pendances.

### Qu'est-ce qu'Uvicorn ?

**Uvicorn** est un serveur ASGI (Asynchronous Server Gateway Interface). En termes simples, c'est le programme qui va faire tourner votre application FastAPI et g√©rer les requ√™tes HTTP.

Pensez √† Uvicorn comme le moteur qui fait fonctionner votre voiture (FastAPI).

### Installation

Installez FastAPI et Uvicorn avec pip :

```bash
pip install fastapi uvicorn[standard]
```

Cette commande installe :
- `fastapi` : Le framework FastAPI lui-m√™me
- `uvicorn[standard]` : Le serveur ASGI avec des fonctionnalit√©s suppl√©mentaires optimales

L'installation peut prendre quelques instants. Une fois termin√©e, vous √™tes pr√™t √† cr√©er votre premi√®re application !

### V√©rifier l'installation

Pour v√©rifier que l'installation s'est bien d√©roul√©e :

```bash
pip list
```

Vous devriez voir `fastapi` et `uvicorn` dans la liste des packages install√©s.

## √âtape 3 : Cr√©er votre premi√®re application FastAPI

Cr√©ez un nouveau fichier Python nomm√© `main.py` dans votre dossier de projet. C'est dans ce fichier que vous allez √©crire le code de votre API.

### Le code minimal

Ouvrez `main.py` et √©crivez ce code :

```python
from fastapi import FastAPI

# Cr√©er une instance de l'application FastAPI
app = FastAPI()

# D√©finir une route simple
@app.get("/")
def lire_racine():
    return {"message": "Bienvenue sur mon API FastAPI !"}
```

C'est tout ! Vous avez cr√©√© votre premi√®re API. Impressionnant, non ? Mais attendez, voyons ce que fait exactement ce code.

### Explication ligne par ligne

```python
from fastapi import FastAPI
```
Cette ligne importe la classe `FastAPI` depuis le module `fastapi`. C'est la classe principale que nous allons utiliser pour cr√©er notre application.

```python
app = FastAPI()
```
Ici, nous cr√©ons une **instance** de FastAPI. Cette instance `app` repr√©sente votre application web. Toutes les routes et configurations seront attach√©es √† cet objet.

```python
@app.get("/")
```
C'est un **d√©corateur** qui d√©finit une route. D√©composons-le :
- `@app.get` : Indique que cette fonction r√©pondra aux requ√™tes HTTP GET
- `"/"` : C'est le chemin de la route (l'URL). `/` signifie la racine de votre site (exemple : `http://localhost:8000/`)

```python
def lire_racine():
    return {"message": "Bienvenue sur mon API FastAPI !"}
```
C'est la fonction qui sera ex√©cut√©e quand quelqu'un acc√®de √† cette route. Elle retourne un dictionnaire Python qui sera automatiquement converti en JSON par FastAPI.

Le r√©sultat sera :
```json
{
    "message": "Bienvenue sur mon API FastAPI !"
}
```

### Structure du projet

√Ä ce stade, votre projet devrait avoir cette structure :

```
mon_premier_fastapi/
‚îÇ
‚îú‚îÄ‚îÄ venv/              # Environnement virtuel (ne pas modifier)
‚îÇ
‚îî‚îÄ‚îÄ main.py            # Votre application FastAPI
```

## √âtape 4 : Lancer votre application

Maintenant, lan√ßons votre application pour voir si tout fonctionne !

Dans votre terminal (avec l'environnement virtuel activ√©), ex√©cutez :

```bash
uvicorn main:app --reload
```

### D√©cortiquons cette commande

- `uvicorn` : Le serveur ASGI qui va faire tourner votre application
- `main` : Le nom de votre fichier Python (sans le `.py`)
- `app` : Le nom de la variable FastAPI dans votre fichier
- `--reload` : Active le rechargement automatique. Quand vous modifiez votre code, le serveur red√©marre automatiquement. **Tr√®s pratique en d√©veloppement !**

### Que se passe-t-il ?

Vous devriez voir quelque chose comme :

```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [12345] using StatReload
INFO:     Started server process [67890]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

F√©licitations ! üéâ Votre serveur est lanc√© et √©coute sur `http://127.0.0.1:8000`.

## √âtape 5 : Tester votre API

Il y a plusieurs fa√ßons de tester votre API. Voyons les principales.

### M√©thode 1 : Le navigateur web

Ouvrez votre navigateur et allez √† l'adresse :

```
http://127.0.0.1:8000/
```

ou

```
http://localhost:8000/
```

Vous devriez voir s'afficher :

```json
{"message": "Bienvenue sur mon API FastAPI !"}
```

C'est la r√©ponse JSON retourn√©e par votre API !

### M√©thode 2 : La documentation interactive (Swagger)

FastAPI g√©n√®re **automatiquement** une documentation interactive pour votre API. C'est l'une de ses fonctionnalit√©s les plus appr√©ci√©es !

Allez √† l'adresse :

```
http://127.0.0.1:8000/docs
```

Vous verrez une interface Swagger √©l√©gante qui liste toutes vos routes et vous permet de les tester directement dans le navigateur.

**Pour tester votre route :**
1. Cliquez sur la route `GET /`
2. Cliquez sur "Try it out"
3. Cliquez sur "Execute"
4. Vous verrez la r√©ponse de votre API

### M√©thode 3 : Documentation alternative (ReDoc)

FastAPI fournit √©galement une autre interface de documentation. Allez √† :

```
http://127.0.0.1:8000/redoc
```

C'est une alternative √† Swagger, au design diff√©rent mais tout aussi fonctionnelle.

### M√©thode 4 : Avec curl (ligne de commande)

Si vous √™tes √† l'aise avec la ligne de commande, vous pouvez utiliser `curl` :

```bash
curl http://127.0.0.1:8000/
```

Ou avec Python et la biblioth√®que `requests` (dans un autre terminal) :

```python
import requests

response = requests.get("http://127.0.0.1:8000/")
print(response.json())
```

## Ajouter plus de routes

Maintenant que votre premi√®re route fonctionne, ajoutons-en d'autres pour comprendre les concepts de base.

### Route avec un message personnalis√©

Modifiez votre fichier `main.py` :

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def lire_racine():
    return {"message": "Bienvenue sur mon API FastAPI !"}

@app.get("/bonjour")
def dire_bonjour():
    return {"message": "Bonjour ! Comment allez-vous ?"}

@app.get("/info")
def obtenir_info():
    return {
        "nom_application": "Mon API",
        "version": "1.0.0",
        "framework": "FastAPI"
    }
```

Sauvegardez le fichier. Gr√¢ce √† l'option `--reload`, le serveur red√©marre automatiquement !

Testez vos nouvelles routes :
- `http://127.0.0.1:8000/bonjour`
- `http://127.0.0.1:8000/info`

### Route avec param√®tre dans l'URL

Vous pouvez √©galement cr√©er des routes avec des param√®tres dynamiques :

```python
@app.get("/utilisateur/{nom}")
def lire_utilisateur(nom: str):
    return {"message": f"Bonjour {nom} !"}
```

Avec cette route, vous pouvez acc√©der √† :
- `http://127.0.0.1:8000/utilisateur/Alice` ‚Üí `{"message": "Bonjour Alice !"}`
- `http://127.0.0.1:8000/utilisateur/Bob` ‚Üí `{"message": "Bonjour Bob !"}`

Le `{nom}` dans l'URL est un **param√®tre de chemin** qui est automatiquement pass√© √† votre fonction.

### Route avec param√®tre d'√¢ge et validation

```python
@app.get("/age/{age}")
def verifier_age(age: int):
    if age >= 18:
        return {"message": f"Vous avez {age} ans, vous √™tes majeur."}
    else:
        return {"message": f"Vous avez {age} ans, vous √™tes mineur."}
```

Remarquez le type `int` pour le param√®tre `age`. FastAPI valide automatiquement que la valeur est bien un nombre entier. Si vous essayez d'acc√©der √† `/age/abc`, vous recevrez une erreur de validation automatique !

## Comprendre les types de requ√™tes HTTP

FastAPI supporte tous les types de requ√™tes HTTP standards. Voici les plus courants :

### GET - R√©cup√©rer des donn√©es

```python
@app.get("/articles")
def lire_articles():
    return {"articles": ["Article 1", "Article 2"]}
```

Utilis√© pour **lire** des donn√©es sans les modifier.

### POST - Cr√©er des donn√©es

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class Article(BaseModel):
    titre: str
    contenu: str

@app.post("/articles")
def creer_article(article: Article):
    return {"message": "Article cr√©√©", "article": article}
```

Utilis√© pour **cr√©er** de nouvelles ressources. Ne vous inqui√©tez pas pour `BaseModel`, nous l'expliquerons dans la prochaine section !

### PUT - Mettre √† jour des donn√©es

```python
@app.put("/articles/{id}")
def modifier_article(id: int, article: Article):
    return {"message": f"Article {id} modifi√©"}
```

Utilis√© pour **mettre √† jour** compl√®tement une ressource existante.

### DELETE - Supprimer des donn√©es

```python
@app.delete("/articles/{id}")
def supprimer_article(id: int):
    return {"message": f"Article {id} supprim√©"}
```

Utilis√© pour **supprimer** une ressource.

## Configuration de l'application

Vous pouvez personnaliser votre application FastAPI lors de sa cr√©ation :

```python
app = FastAPI(
    title="Mon API Super",
    description="Une API incroyable cr√©√©e avec FastAPI",
    version="1.0.0"
)
```

Ces informations appara√Ætront dans la documentation automatique !

## Arr√™ter le serveur

Pour arr√™ter votre serveur, retournez dans votre terminal et appuyez sur :

```
CTRL + C
```

Le serveur s'arr√™tera proprement.

## D√©sactiver l'environnement virtuel

Quand vous avez termin√© de travailler sur votre projet, vous pouvez d√©sactiver l'environnement virtuel :

```bash
deactivate
```

Le pr√©fixe `(venv)` dispara√Ætra de votre ligne de commande.

## Structure compl√®te d'un projet FastAPI de base

Voici √† quoi devrait ressembler votre `main.py` avec toutes les routes que nous avons cr√©√©es :

```python
from fastapi import FastAPI

# Cr√©er l'application avec des m√©tadonn√©es
app = FastAPI(
    title="Mon API FastAPI",
    description="Une API de d√©monstration",
    version="1.0.0"
)

# Route racine
@app.get("/")
def lire_racine():
    return {"message": "Bienvenue sur mon API FastAPI !"}

# Route simple
@app.get("/bonjour")
def dire_bonjour():
    return {"message": "Bonjour ! Comment allez-vous ?"}

# Route avec informations
@app.get("/info")
def obtenir_info():
    return {
        "nom_application": "Mon API",
        "version": "1.0.0",
        "framework": "FastAPI"
    }

# Route avec param√®tre de chemin
@app.get("/utilisateur/{nom}")
def lire_utilisateur(nom: str):
    return {"message": f"Bonjour {nom} !"}

# Route avec validation de type
@app.get("/age/{age}")
def verifier_age(age: int):
    if age >= 18:
        return {"message": f"Vous avez {age} ans, vous √™tes majeur."}
    else:
        return {"message": f"Vous avez {age} ans, vous √™tes mineur."}
```

## Bonnes pratiques pour d√©buter

Voici quelques conseils pour bien d√©marrer avec FastAPI :

### 1. Utilisez toujours un environnement virtuel

Cela √©vite les conflits de d√©pendances et garde votre syst√®me Python propre.

### 2. Utilisez --reload en d√©veloppement

Le flag `--reload` permet au serveur de red√©marrer automatiquement quand vous modifiez votre code.

### 3. Consultez la documentation interactive

L'interface Swagger (`/docs`) est votre meilleure amie pour tester vos routes rapidement.

### 4. Utilisez les type hints

FastAPI utilise les annotations de type Python pour la validation. Habituez-vous √† les utiliser :

```python
def ma_fonction(nom: str, age: int) -> dict:
    return {"nom": nom, "age": age}
```

### 5. Organisez votre code

Pour de petits projets, un seul fichier `main.py` suffit. Mais pour des projets plus importants, pensez √† organiser votre code en modules.

### 6. Gardez le serveur en arri√®re-plan

Vous pouvez ouvrir plusieurs terminaux : un pour le serveur, un autre pour tester vos requ√™tes.

## R√©solution de probl√®mes courants

### Erreur : "Port already in use"

Le port 8000 est d√©j√† utilis√©. Utilisez un autre port :

```bash
uvicorn main:app --reload --port 8001
```

### Erreur : "Module 'fastapi' has no attribute..."

V√©rifiez que vous avez bien activ√© votre environnement virtuel et que FastAPI est install√© :

```bash
pip list | grep fastapi
```

### Le serveur ne red√©marre pas automatiquement

V√©rifiez que vous utilisez bien le flag `--reload` :

```bash
uvicorn main:app --reload
```

### Erreur 404 sur une route

V√©rifiez l'orthographe de votre URL et assurez-vous que la route est bien d√©finie dans votre code.

## Prochaines √©tapes

Maintenant que vous avez cr√©√© votre premi√®re application FastAPI, vous √™tes pr√™t pour d√©couvrir des fonctionnalit√©s plus avanc√©es :

- **Validation des donn√©es** avec Pydantic
- **Param√®tres de requ√™te** (query parameters)
- **Gestion des erreurs** personnalis√©es
- **Connexion √† une base de donn√©es**
- **Authentification** et s√©curit√©

Toutes ces notions seront couvertes dans les prochaines sections !

## R√©capitulatif

Dans cette section, vous avez appris √† :

‚úÖ Cr√©er un environnement virtuel pour isoler vos projets
‚úÖ Installer FastAPI et Uvicorn
‚úÖ Cr√©er votre premi√®re application FastAPI
‚úÖ D√©finir des routes avec diff√©rentes m√©thodes HTTP
‚úÖ Lancer et tester votre API
‚úÖ Utiliser la documentation automatique
‚úÖ Ajouter des param√®tres dans vos routes
‚úÖ Configurer votre application

Vous avez maintenant une base solide pour cr√©er des APIs avec FastAPI. Dans la prochaine section, nous allons approfondir la validation des donn√©es avec Pydantic !

---


‚è≠Ô∏è [Routes et validation avec Pydantic](/11-developpement-web-et-apis/02.2-routes-et-validation-pydantic.md)
